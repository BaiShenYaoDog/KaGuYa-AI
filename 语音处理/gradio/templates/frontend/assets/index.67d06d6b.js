import{S as x,i as ee,s as X,E as V,h as d,k as I,l as P,F as j,q as v,a4 as pt,e as N,R as q,K as ce,N as D,aa as He,ab as Xe,ai as Ge,j as kt,m as W,W as wt,I as mt,d as L,ag as gt,t as k,o as G,b as A,p as K,J as At,a9 as yt,a6 as Se,O as It,P as _e,v as M,w as T,x as B,a3 as Ee,aj as vt,D as H,f as ue,Q,U as Y,r as Ct,u as zt,g as Mt,a as Tt,B as Bt,y as St,z as Et,A as Rt,C as Dt}from"./index.22481e4a.js";import{B as dt}from"./BlockLabel.73f361bb.js";import{I as Re}from"./Image.852ec82c.js";import{C as Ut,i as Lt,U as jt,W as Nt}from"./StaticImage.svelte_svelte_type_style_lang.35041eb3.js";import{I as De,C as Ft,M as Ue}from"./ModifyUpload.10ced328.js";import{U as qt}from"./Upload.d0a4c4c8.js";import{E as Ot}from"./Empty.d6433e20.js";import{U as Wt}from"./UploadText.67c8e429.js";import{E as Xn}from"./Image.18438718.js";/* empty css                                                   */function Pt(t){let e,n,i;return{c(){e=V("svg"),n=V("path"),i=V("path"),d(n,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),d(n,"fill","currentColor"),d(i,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),d(i,"fill","currentColor"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(s,u){I(s,e,u),P(e,n),P(e,i)},p:j,i:j,o:j,d(s){s&&v(e)}}}class Jt extends x{constructor(e){super(),ee(this,e,null,Pt,X,{})}}function Ht(t){let e,n,i,s,u,r,o;return{c(){e=V("svg"),n=V("circle"),i=V("circle"),s=V("circle"),u=V("circle"),r=V("circle"),o=V("path"),d(n,"cx","10"),d(n,"cy","12"),d(n,"r","2"),d(n,"fill","currentColor"),d(i,"cx","16"),d(i,"cy","9"),d(i,"r","2"),d(i,"fill","currentColor"),d(s,"cx","22"),d(s,"cy","12"),d(s,"r","2"),d(s,"fill","currentColor"),d(u,"cx","23"),d(u,"cy","18"),d(u,"r","2"),d(u,"fill","currentColor"),d(r,"cx","19"),d(r,"cy","23"),d(r,"r","2"),d(r,"fill","currentColor"),d(o,"fill","currentColor"),d(o,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(l,c){I(l,e,c),P(e,n),P(e,i),P(e,s),P(e,u),P(e,r),P(e,o)},p:j,i:j,o:j,d(l){l&&v(e)}}}class Qt extends x{constructor(e){super(),ee(this,e,null,Ht,X,{})}}function Yt(t){let e,n;return{c(){e=V("svg"),n=V("path"),d(n,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke","currentColor"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-edit-2")},m(i,s){I(i,e,s),P(e,n)},p:j,i:j,o:j,d(i){i&&v(e)}}}class Ke extends x{constructor(e){super(),ee(this,e,null,Yt,X,{})}}function Vt(t){let e,n;return{c(){e=N("img"),q(e.src,n=t[0])||d(e,"src",n),d(e,"alt","")},m(i,s){I(i,e,s),t[4](e)},p(i,[s]){s&1&&!q(e.src,n=i[0])&&d(e,"src",n)},i:j,o:j,d(i){i&&v(e),t[4](null)}}}function Xt(t,e,n){let{image:i}=e,s;const u=ce();let r;function o(){r.destroy()}function l(){r&&o(),r=new Ut(s,{autoCropArea:1,cropend(){const f=r.getCroppedCanvas().toDataURL();u("crop",f)}}),u("crop",i)}function c(f){D[f?"unshift":"push"](()=>{s=f,n(1,s)})}return t.$$set=f=>{"image"in f&&n(0,i=f.image)},[i,s,o,l,c]}class bt extends x{constructor(e){super(),ee(this,e,Xt,Vt,X,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),pt()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class Ze{constructor(e,n){this.x=e,this.y=n}}class $e extends Ze{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,n){const i=e+Math.PI/2;this.x=this.x+Math.sin(i)*n,this.y=this.y-Math.cos(i)*n}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new Ze(this.x-e.x,this.y-e.y)}getDistanceTo(e){const n=this.getDifferenceTo(e);return Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}getAngleTo(e){const n=this.getDifferenceTo(e);return Math.atan2(n.y,n.x)}toObject(){return{x:this.x,y:this.y}}}const Gt=30;class Kt{constructor({radius:e=Gt,enabled:n=!0,initialPoint:i={x:0,y:0}}={}){this.radius=e,this._isEnabled=n,this.pointer=new $e(i.x,i.y),this.brush=new $e(i.x,i.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:n=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!n?!1:(this.pointer.update(e),n?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}function xe(t,e,n){const i=t.slice();return i[56]=e[n].name,i[57]=e[n].zIndex,i[58]=e,i[59]=n,i}function et(t){let e,n,i;return{c(){e=N("div"),e.textContent="Start drawing",d(e,"class","start-prompt svelte-13f9i4m")},m(s,u){I(s,e,u),i=!0},i(s){i||(He(()=>{n||(n=Xe(e,Ge,{duration:50},!0)),n.run(1)}),i=!0)},o(s){n||(n=Xe(e,Ge,{duration:50},!1)),n.run(0),i=!1},d(s){s&&v(e),s&&n&&n.end()}}}function tt(t){let e,n,i=t[56],s,u;const r=()=>t[27](e,i),o=()=>t[27](null,i);return{c(){e=N("canvas"),d(e,"key",n=t[56]),kt(e,"z-index",t[57]),d(e,"class","svelte-13f9i4m")},m(l,c){I(l,e,c),r(),s||(u=[W(e,"mousedown",t[56]==="interface"?t[6]:void 0),W(e,"mousemove",t[56]==="interface"?t[7]:void 0),W(e,"mouseup",t[56]==="interface"?t[8]:void 0),W(e,"mouseout",t[56]==="interface"?t[8]:void 0),W(e,"blur",t[56]==="interface"?t[8]:void 0),W(e,"touchstart",t[56]==="interface"?t[6]:void 0),W(e,"touchmove",t[56]==="interface"?t[7]:void 0),W(e,"touchend",t[56]==="interface"?t[8]:void 0),W(e,"touchcancel",t[56]==="interface"?t[8]:void 0),W(e,"click",wt(t[26]))],s=!0)},p(l,c){t=l,i!==t[56]&&(o(),i=t[56],r())},d(l){l&&v(e),o(),s=!1,mt(u)}}}function Zt(t){let e,n,i,s,u=t[4]===0&&et(),r=t[5],o=[];for(let l=0;l<r.length;l+=1)o[l]=tt(xe(t,r,l));return{c(){e=N("div"),u&&u.c(),n=L();for(let l=0;l<o.length;l+=1)o[l].c();d(e,"class","wrap svelte-13f9i4m"),He(()=>t[29].call(e))},m(l,c){I(l,e,c),u&&u.m(e,null),P(e,n);for(let f=0;f<o.length;f+=1)o[f].m(e,null);t[28](e),i=gt(e,t[29].bind(e)),s=!0},p(l,c){if(l[4]===0?u?c[0]&16&&k(u,1):(u=et(),u.c(),k(u,1),u.m(e,n)):u&&(G(),A(u,1,1,()=>{u=null}),K()),c[0]&481){r=l[5];let f;for(f=0;f<r.length;f+=1){const g=xe(l,r,f);o[f]?o[f].p(g,c):(o[f]=tt(g),o[f].c(),o[f].m(e,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=r.length}},i(l){s||(k(u),s=!0)},o(l){A(u),s=!1},d(l){l&&v(e),u&&u.d(),At(o,l),t[28](null),i()}}}let $t="#aaa";function nt(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function xt(t,e,n){let i;const s=ce();let{value:u}=e,{value_img:r}=e,{mode:o="sketch"}=e,{brush_color:l="#0b0f19"}=e,{brush_radius:c=50}=e,{source:f}=e,{width:g=400}=e,{height:a=200}=e,{container_height:_=200}=e,b,y=g,U=a,$;const he=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let S={},p={},J=[],O=[],te=!0,ne=!0,ie=!1,w=!1,E=null,Z=null,oe=null,re=0;yt(async()=>{Object.keys(S).forEach(h=>{n(23,p[h]=S[h].getContext("2d"),p)}),await Se(),r&&(r.addEventListener("load",h=>{f==="webcam"?(p.temp.save(),p.temp.translate(g,0),p.temp.scale(-1,1),p.temp.drawImage(r,0,0),p.temp.restore()):p.temp.drawImage(r,0,0),p.drawing.drawImage(S.temp,0,0,g,a),le()}),setTimeout(()=>{f==="webcam"?(p.temp.save(),p.temp.translate(g,0),p.temp.scale(-1,1),p.temp.drawImage(r,0,0),p.temp.restore()):p.temp.drawImage(r,0,0),p.drawing.drawImage(S.temp,0,0,g,a),me({lines:O.slice()}),le()},100)),n(25,E=new Kt({radius:c*.05,enabled:!0,initialPoint:{x:g/2,y:a/2}})),oe=new Lt((h,C,...z)=>{Ae(h,C)}),oe.observe(Z),ge(),n(21,b=!0),requestAnimationFrame(()=>{se(),requestAnimationFrame(()=>{fe()})})});function se(){const h=g/2,C=a/2;E.update({x:h,y:C},{both:!0}),E.update({x:h,y:C},{both:!1}),te=!0,ne=!0}It(()=>{n(21,b=!1),oe.unobserve(Z)});function Le(){const h=O.slice(0,-1);Te(),r&&(f==="webcam"?(p.temp.save(),p.temp.translate(g,0),p.temp.scale(-1,1),p.temp.drawImage(r,0,0),p.temp.restore()):p.temp.drawImage(r,0,0),(!O||!O.length)&&p.drawing.drawImage(S.temp,0,0,g,a)),me({lines:h}),n(4,re=h.length),O.length&&n(24,O=h),O.length==0&&s("clear"),le()}let me=({lines:h})=>{h.forEach(C=>{const{points:z,brush_color:R,brush_radius:m}=C;ve({points:z,brush_color:R,brush_radius:m}),o==="mask"&&Ce({points:z,brush_color:R,brush_radius:m}),J=z}),Me({brush_color:l,brush_radius:c}),o==="mask"&&ze()},je=h=>{h.preventDefault(),w=!0;const{x:C,y:z}=ye(h);h.touches&&h.touches.length>0&&E.update({x:C,y:z},{both:!0}),Ie(C,z),n(4,re+=1)},be=h=>{h.preventDefault();const{x:C,y:z}=ye(h);Ie(C,z)},Ne=h=>{h.preventDefault(),be(h),ie=!1,w=!1,Me(),o==="mask"&&ze()},pe=0,ke=0,we=0,Ae=async()=>{if(g===pe&&a===ke&&we===_)return;const h={width:g,height:a},C={height:_,width:_*(h.width/h.height)};await Promise.all([ae(S.interface,h,C),ae(S.drawing,h,C),ae(S.temp,h,C),ae(S.temp_fake,h,C),ae(S.mask,h,C,!1)]),n(9,c=20*(h.width/C.width)),ge({once:!0}),setTimeout(()=>{ke=a,pe=g,we=_},100),fe()},ae=async(h,C,z,R=!0)=>{if(!b)return;await Se();const m=window.devicePixelRatio||1;h.width=C.width*(R?m:1),h.height=C.height*(R?m:1);const F=h.getContext("2d");R&&F.scale(m,m),h.style.width=`${z.width}px`,h.style.height=`${z.height}px`},ye=h=>{const C=S.interface.getBoundingClientRect();let z=h.clientX,R=h.clientY;return h.changedTouches&&h.changedTouches.length>0&&(z=h.changedTouches[0].clientX,R=h.changedTouches[0].clientY),{x:(z-C.left)/C.width*g,y:(R-C.top)/C.height*a}},Ie=(h,C)=>{E.update({x:h,y:C});const z=!E.isEnabled();(w&&!ie||z&&w)&&(ie=!0,J.push(E.brush.toObject())),ie&&(J.push(E.brush.toObject()),ve({points:J,brush_color:l,brush_radius:c}),o==="mask"&&Ce({points:J,brush_color:l,brush_radius:c})),te=!0},ve=({points:h,brush_color:C,brush_radius:z})=>{if(!h||h.length<2||(n(23,p.temp.lineJoin="round",p),n(23,p.temp.lineCap="round",p),n(23,p.temp.strokeStyle=C,p),n(23,p.temp.lineWidth=z,p),!h||h.length<2))return;let R=h[0],m=h[1];p.temp.moveTo(m.x,m.y),p.temp.beginPath();for(var F=1,Je=h.length;F<Je;F++){var de=nt(R,m);p.temp.quadraticCurveTo(R.x,R.y,de.x,de.y),R=h[F],m=h[F+1]}p.temp.lineTo(R.x,R.y),p.temp.stroke()},Ce=({points:h,brush_color:C,brush_radius:z})=>{if(!h||h.length<2)return;n(23,p.temp_fake.lineJoin="round",p),n(23,p.temp_fake.lineCap="round",p),n(23,p.temp_fake.strokeStyle="#fff",p),n(23,p.temp_fake.lineWidth=z,p);let R=h[0],m=h[1];p.temp_fake.moveTo(m.x,m.y),p.temp_fake.beginPath();for(var F=1,Je=h.length;F<Je;F++){var de=nt(R,m);p.temp_fake.quadraticCurveTo(R.x,R.y,de.x,de.y),R=h[F],m=h[F+1]}p.temp_fake.lineTo(R.x,R.y),p.temp_fake.stroke()},ze=()=>{J.length<1||(J.length=0,p.mask.drawImage(S.temp_fake,0,0,g,a),le())},Me=()=>{J.length<1||(O.push({points:J.slice(),brush_color:l,brush_radius:c}),o!=="mask"&&(J.length=0),p.drawing.drawImage(S.temp,0,0,g,a),le())},le=()=>{const h=Be();s("change",h)};function fe(){return n(24,O=[]),Te(),n(4,re=0),!0}function Te(){ne=!0,p.temp.clearRect(0,0,g,a),n(23,p.temp.fillStyle=o==="mask"?"transparent":"#FFFFFF",p),p.temp.fillRect(0,0,g,a),o==="mask"&&(p.temp_fake.clearRect(0,0,S.temp_fake.width,S.temp_fake.height),p.mask.clearRect(0,0,g,a),n(23,p.mask.fillStyle="#000",p),p.mask.fillRect(0,0,g,a))}let ge=({once:h=!1}={})=>{if(te||ne){const C=E.getPointerCoordinates(),z=E.getBrushCoordinates();Fe(p.interface,C,z),te=!1,ne=!1}h||window.requestAnimationFrame(()=>{ge()})},Fe=(h,C,z)=>{h.clearRect(0,0,g,a),h.beginPath(),h.fillStyle=l,h.arc(z.x,z.y,c/2,0,Math.PI*2,!0),h.fill(),h.beginPath(),h.fillStyle=$t,h.arc(z.x,z.y,i,0,Math.PI*2,!0),h.fill()};function Be(){return o==="mask"?S.mask.toDataURL("image/jpg"):S.drawing.toDataURL("image/jpg")}function qe(h){_e.call(this,t,h)}function Oe(h,C){D[h?"unshift":"push"](()=>{S[C]=h,n(0,S)})}function We(h){D[h?"unshift":"push"](()=>{Z=h,n(3,Z)})}function Pe(){y=this.offsetWidth,U=this.offsetHeight,n(1,y),n(2,U)}return t.$$set=h=>{"value"in h&&n(10,u=h.value),"value_img"in h&&n(11,r=h.value_img),"mode"in h&&n(12,o=h.mode),"brush_color"in h&&n(13,l=h.brush_color),"brush_radius"in h&&n(9,c=h.brush_radius),"source"in h&&n(14,f=h.source),"width"in h&&n(15,g=h.width),"height"in h&&n(16,a=h.height),"container_height"in h&&n(17,_=h.container_height)},t.$$.update=()=>{t.$$.dirty[0]&2098176&&b&&!u&&fe(),t.$$.dirty[0]&31574017&&b&&r!==$&&(n(22,$=r),fe(),setTimeout(()=>{f==="webcam"?(p.temp.save(),p.temp.translate(g,0),p.temp.scale(-1,1),p.temp.drawImage(r,0,0),p.temp.restore()):p.temp.drawImage(r,0,0),p.drawing.drawImage(S.temp,0,0,g,a),me({lines:O.slice()}),le()},50)),t.$$.dirty[0]&33554944&&E&&(se(),E.setRadius(c*.05)),t.$$.dirty[0]&98304&&(g||a)&&Ae(),t.$$.dirty[0]&512&&(i=c*.075)},[S,y,U,Z,re,he,je,be,Ne,c,u,r,o,l,f,g,a,_,Le,fe,Be,b,$,p,O,E,qe,Oe,We,Pe]}class Qe extends x{constructor(e){super(),ee(this,e,xt,Zt,X,{value:10,value_img:11,mode:12,brush_color:13,brush_radius:9,source:14,width:15,height:16,container_height:17,undo:18,clear:19,get_image_data:20},null,[-1,-1])}get undo(){return this.$$.ctx[18]}get clear(){return this.$$.ctx[19]}get get_image_data(){return this.$$.ctx[20]}}function en(t){let e,n,i,s,u;return n=new De({props:{Icon:jt,label:"Undo"}}),n.$on("click",t[1]),s=new De({props:{Icon:Ft,label:"Clear"}}),s.$on("click",t[2]),{c(){e=N("div"),M(n.$$.fragment),i=L(),M(s.$$.fragment),d(e,"class","svelte-16330ex")},m(r,o){I(r,e,o),T(n,e,null),P(e,i),T(s,e,null),u=!0},p:j,i(r){u||(k(n.$$.fragment,r),k(s.$$.fragment,r),u=!0)},o(r){A(n.$$.fragment,r),A(s.$$.fragment,r),u=!1},d(r){r&&v(e),B(n),B(s)}}}function tn(t){const e=ce();return[e,()=>e("undo"),s=>{e("clear"),s.stopPropagation()}]}class Ye extends x{constructor(e){super(),ee(this,e,tn,en,X,{})}}function it(t){let e,n,i,s,u;return{c(){e=N("input"),d(e,"aria-label","Brush radius"),d(e,"type","range"),d(e,"min",n=.5*(t[2]/t[6])),d(e,"max",i=75*(t[2]/t[6])),d(e,"class","svelte-11lfbcw")},m(r,o){I(r,e,o),Ee(e,t[0]),s||(u=[W(e,"change",t[10]),W(e,"input",t[10])],s=!0)},p(r,o){o&68&&n!==(n=.5*(r[2]/r[6]))&&d(e,"min",n),o&68&&i!==(i=75*(r[2]/r[6]))&&d(e,"max",i),o&1&&Ee(e,r[0])},d(r){r&&v(e),s=!1,mt(u)}}}function rt(t){let e,n,i,s;n=new De({props:{Icon:Qt,label:"Select brush color"}}),n.$on("click",t[11]);let u=t[5]&&st(t);return{c(){e=N("span"),M(n.$$.fragment),i=L(),u&&u.c(),d(e,"class","col svelte-11lfbcw")},m(r,o){I(r,e,o),T(n,e,null),P(e,i),u&&u.m(e,null),s=!0},p(r,o){r[5]?u?u.p(r,o):(u=st(r),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(r){s||(k(n.$$.fragment,r),s=!0)},o(r){A(n.$$.fragment,r),s=!1},d(r){r&&v(e),B(n),u&&u.d()}}}function st(t){let e,n,i;return{c(){e=N("input"),d(e,"aria-label","Brush color"),d(e,"type","color"),d(e,"class","svelte-11lfbcw")},m(s,u){I(s,e,u),Ee(e,t[1]),n||(i=W(e,"input",t[12]),n=!0)},p(s,u){u&2&&Ee(e,s[1])},d(s){s&&v(e),n=!1,i()}}}function nn(t){let e,n,i,s,u,r;i=new De({props:{Icon:Jt,label:"Use brush"}}),i.$on("click",t[9]);let o=t[4]&&it(t),l=t[3]!=="mask"&&rt(t);return{c(){e=N("div"),n=N("span"),M(i.$$.fragment),s=L(),o&&o.c(),u=L(),l&&l.c(),d(n,"class","brush svelte-11lfbcw"),d(e,"class","wrap svelte-11lfbcw")},m(c,f){I(c,e,f),P(e,n),T(i,n,null),P(n,s),o&&o.m(n,null),P(e,u),l&&l.m(e,null),r=!0},p(c,[f]){c[4]?o?o.p(c,f):(o=it(c),o.c(),o.m(n,null)):o&&(o.d(1),o=null),c[3]!=="mask"?l?(l.p(c,f),f&8&&k(l,1)):(l=rt(c),l.c(),k(l,1),l.m(e,null)):l&&(G(),A(l,1,1,()=>{l=null}),K())},i(c){r||(k(i.$$.fragment,c),k(l),r=!0)},o(c){A(i.$$.fragment,c),A(l),r=!1},d(c){c&&v(e),B(i),o&&o.d(),l&&l.d()}}}function rn(t,e,n){let i;ce();let s=!1,u=!1,{brush_radius:r=20}=e,{brush_color:o="#000"}=e,{container_height:l}=e,{img_width:c}=e,{img_height:f}=e,{mode:g="other"}=e;const a=()=>n(4,s=!s);function _(){r=vt(this.value),n(0,r)}const b=()=>n(5,u=!u);function y(){o=this.value,n(1,o)}return t.$$set=U=>{"brush_radius"in U&&n(0,r=U.brush_radius),"brush_color"in U&&n(1,o=U.brush_color),"container_height"in U&&n(7,l=U.container_height),"img_width"in U&&n(2,c=U.img_width),"img_height"in U&&n(8,f=U.img_height),"mode"in U&&n(3,g=U.mode)},t.$$.update=()=>{t.$$.dirty&388&&n(6,i=l*(c/f))},[r,o,c,g,s,u,i,l,f,a,_,b,y]}class Ve extends x{constructor(e){super(),ee(this,e,rn,nn,X,{brush_radius:0,brush_color:1,container_height:7,img_width:2,img_height:8,mode:3})}}function sn(t){let e,n;return{c(){e=N("img"),q(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-zyic3i"),H(e,"webcam",t[4]==="webcam"&&t[7])},m(i,s){I(i,e,s)},p(i,s){s[0]&1&&!q(e.src,n=i[0].image||i[0])&&d(e,"src",n),s[0]&144&&H(e,"webcam",i[4]==="webcam"&&i[7])},i:j,o:j,d(i){i&&v(e)}}}function ln(t){let e=t[19],n,i,s,u=lt(t),r=t[13]>0&&ut(t);return{c(){u.c(),n=L(),r&&r.c(),i=ue()},m(o,l){u.m(o,l),I(o,n,l),r&&r.m(o,l),I(o,i,l),s=!0},p(o,l){l[0]&524288&&X(e,e=o[19])?(u.d(1),u=lt(o),u.c(),u.m(n.parentNode,n)):u.p(o,l),o[13]>0?r?(r.p(o,l),l[0]&8192&&k(r,1)):(r=ut(o),r.c(),k(r,1),r.m(i.parentNode,i)):r&&(G(),A(r,1,1,()=>{r=null}),K())},i(o){s||(k(r),s=!0)},o(o){A(r),s=!1},d(o){u.d(o),o&&v(n),r&&r.d(o),o&&v(i)}}}function un(t){let e,n,i,s,u;return e=new Ue({props:{editable:!0}}),e.$on("edit",t[48]),e.$on("clear",t[22]),{c(){M(e.$$.fragment),n=L(),i=N("img"),q(i.src,s=t[0])||d(i,"src",s),d(i,"alt",""),d(i,"class","svelte-zyic3i"),H(i,"webcam",t[4]==="webcam"&&t[7])},m(r,o){T(e,r,o),I(r,n,o),I(r,i,o),u=!0},p(r,o){(!u||o[0]&1&&!q(i.src,s=r[0]))&&d(i,"src",s),o[0]&144&&H(i,"webcam",r[4]==="webcam"&&r[7])},i(r){u||(k(e.$$.fragment,r),u=!0)},o(r){A(e.$$.fragment,r),u=!1},d(r){B(e,r),r&&v(n),r&&v(i)}}}function on(t){let e,n,i,s,u={image:t[0]};return e=new bt({props:u}),t[46](e),e.$on("crop",t[23]),i=new Ue({}),i.$on("clear",t[47]),{c(){M(e.$$.fragment),n=L(),M(i.$$.fragment)},m(r,o){T(e,r,o),I(r,n,o),T(i,r,o),s=!0},p(r,o){const l={};o[0]&1&&(l.image=r[0]),e.$set(l)},i(r){s||(k(e.$$.fragment,r),k(i.$$.fragment,r),s=!0)},o(r){A(e.$$.fragment,r),A(i.$$.fragment,r),s=!1},d(r){t[46](null),B(e,r),r&&v(n),B(i,r)}}}function an(t){let e,n,i=t[4]==="webcam"&&!t[19]&&at(t);return{c(){i&&i.c(),e=ue()},m(s,u){i&&i.m(s,u),I(s,e,u),n=!0},p(s,u){s[4]==="webcam"&&!s[19]?i?(i.p(s,u),u[0]&524304&&k(i,1)):(i=at(s),i.c(),k(i,1),i.m(e.parentNode,e)):i&&(G(),A(i,1,1,()=>{i=null}),K())},i(s){n||(k(i),n=!0)},o(s){A(i),n=!1},d(s){i&&i.d(s),s&&v(e)}}}function fn(t){let e,n,i,s,u,r,o;e=new Ye({}),e.$on("undo",t[38]),e.$on("clear",t[25]);let l=t[1]==="color-sketch"&&ft(t);function c(a){t[41](a)}function f(a){t[42](a)}let g={value:t[0],mode:t[10],width:t[13]||t[18],height:t[12]||t[17],container_height:t[14]||t[17]};return t[15]!==void 0&&(g.brush_radius=t[15]),t[20]!==void 0&&(g.brush_color=t[20]),s=new Qe({props:g}),D.push(()=>Y(s,"brush_radius",c)),D.push(()=>Y(s,"brush_color",f)),t[43](s),s.$on("change",t[23]),s.$on("clear",t[25]),{c(){M(e.$$.fragment),n=L(),l&&l.c(),i=L(),M(s.$$.fragment)},m(a,_){T(e,a,_),I(a,n,_),l&&l.m(a,_),I(a,i,_),T(s,a,_),o=!0},p(a,_){a[1]==="color-sketch"?l?(l.p(a,_),_[0]&2&&k(l,1)):(l=ft(a),l.c(),k(l,1),l.m(i.parentNode,i)):l&&(G(),A(l,1,1,()=>{l=null}),K());const b={};_[0]&1&&(b.value=a[0]),_[0]&1024&&(b.mode=a[10]),_[0]&270336&&(b.width=a[13]||a[18]),_[0]&135168&&(b.height=a[12]||a[17]),_[0]&147456&&(b.container_height=a[14]||a[17]),!u&&_[0]&32768&&(u=!0,b.brush_radius=a[15],Q(()=>u=!1)),!r&&_[0]&1048576&&(r=!0,b.brush_color=a[20],Q(()=>r=!1)),s.$set(b)},i(a){o||(k(e.$$.fragment,a),k(l),k(s.$$.fragment,a),o=!0)},o(a){A(e.$$.fragment,a),A(l),A(s.$$.fragment,a),o=!1},d(a){B(e,a),a&&v(n),l&&l.d(a),a&&v(i),t[43](null),B(s,a)}}}function _n(t){let e,n,i;function s(r){t[37](r)}let u={filetype:"image/png,image/gif,image/jpeg",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[bn]},$$scope:{ctx:t}};return t[9]!==void 0&&(u.dragging=t[9]),e=new qt({props:u}),D.push(()=>Y(e,"dragging",s)),e.$on("load",t[21]),{c(){M(e.$$.fragment)},m(r,o){T(e,r,o),i=!0},p(r,o){const l={};o[0]&1&&(l.disable_click=!!r[0]),o[0]&2096563|o[1]&67108864&&(l.$$scope={dirty:o,ctx:r}),!n&&o[0]&512&&(n=!0,l.dragging=r[9],Q(()=>n=!1)),e.$set(l)},i(r){i||(k(e.$$.fragment,r),i=!0)},o(r){A(e.$$.fragment,r),i=!1},d(r){B(e,r)}}}function lt(t){let e,n,i,s;return{c(){e=N("img"),d(e,"class","absolute-img svelte-zyic3i"),q(e.src,n=t[19]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt",""),H(e,"webcam",t[4]==="webcam"&&t[7])},m(u,r){I(u,e,r),t[49](e),i||(s=W(e,"load",t[24]),i=!0)},p(u,r){r[0]&524289&&!q(e.src,n=u[19]||u[0]?.image||u[0])&&d(e,"src",n),r[0]&144&&H(e,"webcam",u[4]==="webcam"&&u[7])},d(u){u&&v(e),t[49](null),i=!1,s()}}}function ut(t){let e,n,i,s,u,r,o,l;function c(_){t[51](_)}function f(_){t[52](_)}let g={value:t[0],mode:t[10],width:t[13]||t[18],height:t[12]||t[17],container_height:t[14]||t[17],value_img:t[16],source:t[4]};t[15]!==void 0&&(g.brush_radius=t[15]),t[20]!==void 0&&(g.brush_color=t[20]),e=new Qe({props:g}),t[50](e),D.push(()=>Y(e,"brush_radius",c)),D.push(()=>Y(e,"brush_color",f)),e.$on("change",t[23]),u=new Ye({}),u.$on("undo",t[53]),u.$on("clear",t[25]);let a=(t[1]==="color-sketch"||t[1]==="sketch")&&ot(t);return{c(){M(e.$$.fragment),s=L(),M(u.$$.fragment),r=L(),a&&a.c(),o=ue()},m(_,b){T(e,_,b),I(_,s,b),T(u,_,b),I(_,r,b),a&&a.m(_,b),I(_,o,b),l=!0},p(_,b){const y={};b[0]&1&&(y.value=_[0]),b[0]&1024&&(y.mode=_[10]),b[0]&270336&&(y.width=_[13]||_[18]),b[0]&135168&&(y.height=_[12]||_[17]),b[0]&147456&&(y.container_height=_[14]||_[17]),b[0]&65536&&(y.value_img=_[16]),b[0]&16&&(y.source=_[4]),!n&&b[0]&32768&&(n=!0,y.brush_radius=_[15],Q(()=>n=!1)),!i&&b[0]&1048576&&(i=!0,y.brush_color=_[20],Q(()=>i=!1)),e.$set(y),_[1]==="color-sketch"||_[1]==="sketch"?a?(a.p(_,b),b[0]&2&&k(a,1)):(a=ot(_),a.c(),k(a,1),a.m(o.parentNode,o)):a&&(G(),A(a,1,1,()=>{a=null}),K())},i(_){l||(k(e.$$.fragment,_),k(u.$$.fragment,_),k(a),l=!0)},o(_){A(e.$$.fragment,_),A(u.$$.fragment,_),A(a),l=!1},d(_){t[50](null),B(e,_),_&&v(s),B(u,_),_&&v(r),a&&a.d(_),_&&v(o)}}}function ot(t){let e,n,i,s;function u(l){t[54](l)}function r(l){t[55](l)}let o={container_height:t[14]||t[17],img_width:t[13]||t[18],img_height:t[12]||t[17],mode:t[10]};return t[15]!==void 0&&(o.brush_radius=t[15]),t[20]!==void 0&&(o.brush_color=t[20]),e=new Ve({props:o}),D.push(()=>Y(e,"brush_radius",u)),D.push(()=>Y(e,"brush_color",r)),{c(){M(e.$$.fragment)},m(l,c){T(e,l,c),s=!0},p(l,c){const f={};c[0]&147456&&(f.container_height=l[14]||l[17]),c[0]&270336&&(f.img_width=l[13]||l[18]),c[0]&135168&&(f.img_height=l[12]||l[17]),c[0]&1024&&(f.mode=l[10]),!n&&c[0]&32768&&(n=!0,f.brush_radius=l[15],Q(()=>n=!1)),!i&&c[0]&1048576&&(i=!0,f.brush_color=l[20],Q(()=>i=!1)),e.$set(f)},i(l){s||(k(e.$$.fragment,l),s=!0)},o(l){A(e.$$.fragment,l),s=!1},d(l){B(e,l)}}}function at(t){let e,n;return e=new Nt({props:{streaming:t[5],pending:t[6],mirror_webcam:t[7]}}),e.$on("capture",t[44]),e.$on("stream",t[23]),e.$on("error",t[45]),{c(){M(e.$$.fragment)},m(i,s){T(e,i,s),n=!0},p(i,s){const u={};s[0]&32&&(u.streaming=i[5]),s[0]&64&&(u.pending=i[6]),s[0]&128&&(u.mirror_webcam=i[7]),e.$set(u)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){B(e,i)}}}function ft(t){let e,n,i,s;function u(l){t[39](l)}function r(l){t[40](l)}let o={container_height:t[14]||t[17],img_width:t[13]||t[18],img_height:t[12]||t[17]};return t[15]!==void 0&&(o.brush_radius=t[15]),t[20]!==void 0&&(o.brush_color=t[20]),e=new Ve({props:o}),D.push(()=>Y(e,"brush_radius",u)),D.push(()=>Y(e,"brush_color",r)),{c(){M(e.$$.fragment)},m(l,c){T(e,l,c),s=!0},p(l,c){const f={};c[0]&147456&&(f.container_height=l[14]||l[17]),c[0]&270336&&(f.img_width=l[13]||l[18]),c[0]&135168&&(f.img_height=l[12]||l[17]),!n&&c[0]&32768&&(n=!0,f.brush_radius=l[15],Q(()=>n=!1)),!i&&c[0]&1048576&&(i=!0,f.brush_color=l[20],Q(()=>i=!1)),e.$set(f)},i(l){s||(k(e.$$.fragment,l),s=!0)},o(l){A(e.$$.fragment,l),s=!1},d(l){B(e,l)}}}function cn(t){let e,n;return{c(){e=N("img"),q(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-zyic3i"),H(e,"webcam",t[4]==="webcam"&&t[7])},m(i,s){I(i,e,s)},p(i,s){s[0]&1&&!q(e.src,n=i[0].image||i[0])&&d(e,"src",n),s[0]&144&&H(e,"webcam",i[4]==="webcam"&&i[7])},i:j,o:j,d(i){i&&v(e)}}}function hn(t){let e=t[19],n,i,s,u=_t(t),r=t[13]>0&&ct(t);return{c(){u.c(),n=L(),r&&r.c(),i=ue()},m(o,l){u.m(o,l),I(o,n,l),r&&r.m(o,l),I(o,i,l),s=!0},p(o,l){l[0]&524288&&X(e,e=o[19])?(u.d(1),u=_t(o),u.c(),u.m(n.parentNode,n)):u.p(o,l),o[13]>0?r?(r.p(o,l),l[0]&8192&&k(r,1)):(r=ct(o),r.c(),k(r,1),r.m(i.parentNode,i)):r&&(G(),A(r,1,1,()=>{r=null}),K())},i(o){s||(k(r),s=!0)},o(o){A(r),s=!1},d(o){u.d(o),o&&v(n),r&&r.d(o),o&&v(i)}}}function mn(t){let e,n,i,s,u;return e=new Ue({props:{editable:!0}}),e.$on("edit",t[29]),e.$on("clear",t[22]),{c(){M(e.$$.fragment),n=L(),i=N("img"),q(i.src,s=t[0])||d(i,"src",s),d(i,"alt",""),d(i,"class","svelte-zyic3i"),H(i,"scale-x-[-1]",t[4]==="webcam"&&t[7])},m(r,o){T(e,r,o),I(r,n,o),I(r,i,o),u=!0},p(r,o){(!u||o[0]&1&&!q(i.src,s=r[0]))&&d(i,"src",s),o[0]&144&&H(i,"scale-x-[-1]",r[4]==="webcam"&&r[7])},i(r){u||(k(e.$$.fragment,r),u=!0)},o(r){A(e.$$.fragment,r),u=!1},d(r){B(e,r),r&&v(n),r&&v(i)}}}function gn(t){let e,n,i,s,u={image:t[0]};return e=new bt({props:u}),t[27](e),e.$on("crop",t[23]),i=new Ue({}),i.$on("clear",t[28]),{c(){M(e.$$.fragment),n=L(),M(i.$$.fragment)},m(r,o){T(e,r,o),I(r,n,o),T(i,r,o),s=!0},p(r,o){const l={};o[0]&1&&(l.image=r[0]),e.$set(l)},i(r){s||(k(e.$$.fragment,r),k(i.$$.fragment,r),s=!0)},o(r){A(e.$$.fragment,r),A(i.$$.fragment,r),s=!1},d(r){t[27](null),B(e,r),r&&v(n),B(i,r)}}}function dn(t){let e;const n=t[26].default,i=Ct(n,t,t[57],null);return{c(){i&&i.c()},m(s,u){i&&i.m(s,u),e=!0},p(s,u){i&&i.p&&(!e||u[1]&67108864)&&zt(i,n,s,s[57],e?Tt(n,s[57],u,null):Mt(s[57]),null)},i(s){e||(k(i,s),e=!0)},o(s){A(i,s),e=!1},d(s){i&&i.d(s)}}}function _t(t){let e,n,i,s;return{c(){e=N("img"),d(e,"class","absolute-img svelte-zyic3i"),q(e.src,n=t[19]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt",""),H(e,"webcam",t[4]==="webcam"&&t[7])},m(u,r){I(u,e,r),t[30](e),i||(s=W(e,"load",t[24]),i=!0)},p(u,r){r[0]&524289&&!q(e.src,n=u[19]||u[0]?.image||u[0])&&d(e,"src",n),r[0]&144&&H(e,"webcam",u[4]==="webcam"&&u[7])},d(u){u&&v(e),t[30](null),i=!1,s()}}}function ct(t){let e,n,i,s,u,r,o,l;function c(_){t[32](_)}function f(_){t[33](_)}let g={value:t[0],mode:t[10],width:t[13]||t[18],height:t[12]||t[17],container_height:t[14]||t[17],value_img:t[16],source:t[4]};t[15]!==void 0&&(g.brush_radius=t[15]),t[20]!==void 0&&(g.brush_color=t[20]),e=new Qe({props:g}),t[31](e),D.push(()=>Y(e,"brush_radius",c)),D.push(()=>Y(e,"brush_color",f)),e.$on("change",t[23]),u=new Ye({}),u.$on("undo",t[34]),u.$on("clear",t[25]);let a=(t[1]==="color-sketch"||t[1]==="sketch")&&ht(t);return{c(){M(e.$$.fragment),s=L(),M(u.$$.fragment),r=L(),a&&a.c(),o=ue()},m(_,b){T(e,_,b),I(_,s,b),T(u,_,b),I(_,r,b),a&&a.m(_,b),I(_,o,b),l=!0},p(_,b){const y={};b[0]&1&&(y.value=_[0]),b[0]&1024&&(y.mode=_[10]),b[0]&270336&&(y.width=_[13]||_[18]),b[0]&135168&&(y.height=_[12]||_[17]),b[0]&147456&&(y.container_height=_[14]||_[17]),b[0]&65536&&(y.value_img=_[16]),b[0]&16&&(y.source=_[4]),!n&&b[0]&32768&&(n=!0,y.brush_radius=_[15],Q(()=>n=!1)),!i&&b[0]&1048576&&(i=!0,y.brush_color=_[20],Q(()=>i=!1)),e.$set(y),_[1]==="color-sketch"||_[1]==="sketch"?a?(a.p(_,b),b[0]&2&&k(a,1)):(a=ht(_),a.c(),k(a,1),a.m(o.parentNode,o)):a&&(G(),A(a,1,1,()=>{a=null}),K())},i(_){l||(k(e.$$.fragment,_),k(u.$$.fragment,_),k(a),l=!0)},o(_){A(e.$$.fragment,_),A(u.$$.fragment,_),A(a),l=!1},d(_){t[31](null),B(e,_),_&&v(s),B(u,_),_&&v(r),a&&a.d(_),_&&v(o)}}}function ht(t){let e,n,i,s;function u(l){t[35](l)}function r(l){t[36](l)}let o={container_height:t[14]||t[17],img_width:t[13]||t[18],img_height:t[12]||t[17],mode:t[10]};return t[15]!==void 0&&(o.brush_radius=t[15]),t[20]!==void 0&&(o.brush_color=t[20]),e=new Ve({props:o}),D.push(()=>Y(e,"brush_radius",u)),D.push(()=>Y(e,"brush_color",r)),{c(){M(e.$$.fragment)},m(l,c){T(e,l,c),s=!0},p(l,c){const f={};c[0]&147456&&(f.container_height=l[14]||l[17]),c[0]&270336&&(f.img_width=l[13]||l[18]),c[0]&135168&&(f.img_height=l[12]||l[17]),c[0]&1024&&(f.mode=l[10]),!n&&c[0]&32768&&(n=!0,f.brush_radius=l[15],Q(()=>n=!1)),!i&&c[0]&1048576&&(i=!0,f.brush_color=l[20],Q(()=>i=!1)),e.$set(f)},i(l){s||(k(e.$$.fragment,l),s=!0)},o(l){A(e.$$.fragment,l),s=!1},d(l){B(e,l)}}}function bn(t){let e,n,i,s;const u=[dn,gn,mn,hn,cn],r=[];function o(l,c){return l[0]===null&&!l[19]||l[5]?0:l[1]==="select"?1:l[1]==="editor"?2:(l[1]==="sketch"||l[1]==="color-sketch")&&(l[0]!==null||l[19])?3:4}return e=o(t),n=r[e]=u[e](t),{c(){n.c(),i=ue()},m(l,c){r[e].m(l,c),I(l,i,c),s=!0},p(l,c){let f=e;e=o(l),e===f?r[e].p(l,c):(G(),A(r[f],1,1,()=>{r[f]=null}),K(),n=r[e],n?n.p(l,c):(n=r[e]=u[e](l),n.c()),k(n,1),n.m(i.parentNode,i))},i(l){s||(k(n),s=!0)},o(l){A(n),s=!1},d(l){r[e].d(l),l&&v(i)}}}function pn(t){let e,n,i,s,u,r,o;e=new dt({props:{show_label:t[3],Icon:t[4]==="canvas"?Ke:Re,label:t[2]||(t[4]==="canvas"?"Sketch":"Image")}});const l=[_n,fn,an,on,un,ln,sn],c=[];function f(g,a){return g[4]==="upload"?0:g[4]==="canvas"?1:g[0]===null&&!g[19]||g[5]?2:g[1]==="select"?3:g[1]==="editor"?4:(g[1]==="sketch"||g[1]==="color-sketch")&&(g[0]!==null||g[19])?5:6}return s=f(t),u=c[s]=l[s](t),{c(){M(e.$$.fragment),n=L(),i=N("div"),u.c(),d(i,"data-testid","image"),d(i,"class","svelte-zyic3i"),He(()=>t[56].call(i)),H(i,"fixed-height",t[4]!=="webcam"||t[1]==="sketch"||t[1]==="color-sketch")},m(g,a){T(e,g,a),I(g,n,a),I(g,i,a),c[s].m(i,null),r=gt(i,t[56].bind(i)),o=!0},p(g,a){const _={};a[0]&8&&(_.show_label=g[3]),a[0]&16&&(_.Icon=g[4]==="canvas"?Ke:Re),a[0]&20&&(_.label=g[2]||(g[4]==="canvas"?"Sketch":"Image")),e.$set(_);let b=s;s=f(g),s===b?c[s].p(g,a):(G(),A(c[b],1,1,()=>{c[b]=null}),K(),u=c[s],u?u.p(g,a):(u=c[s]=l[s](g),u.c()),k(u,1),u.m(i,null)),a[0]&18&&H(i,"fixed-height",g[4]!=="webcam"||g[1]==="sketch"||g[1]==="color-sketch")},i(g){o||(k(e.$$.fragment,g),k(u),o=!0)},o(g){A(e.$$.fragment,g),A(u),o=!1},d(g){B(e,g),g&&v(n),g&&v(i),c[s].d(),r()}}}function kn(t,e,n){let i,{$$slots:s={},$$scope:u}=e,{value:r}=e,{label:o=void 0}=e,{show_label:l}=e,{source:c="upload"}=e,{tool:f="editor"}=e,{streaming:g=!1}=e,{pending:a=!1}=e,{mirror_webcam:_}=e,b,y;r&&(c==="upload"||c==="webcam")&&f==="sketch"&&(r={image:r,mask:null});function U({detail:m}){f==="color-sketch"?n(19,se=m):n(0,r=(c==="upload"||c==="webcam")&&f==="sketch"?{image:m,mask:null}:m),S("upload",m)}function $({detail:m}){n(0,r=null),n(19,se=void 0),S("clear")}async function he({detail:m},F){E==="mask"?c==="webcam"&&F?n(0,r={image:m,mask:null}):n(0,r={image:typeof r=="string"?r:r?.image||null,mask:m}):(c==="upload"||c==="webcam")&&f==="sketch"?n(0,r={image:m,mask:null}):n(0,r=m),await Se(),S(g?"stream":"edit")}const S=ce();let p=!1;function J(m){const F=m.composedPath()[0];n(13,ne=F.naturalWidth),n(12,te=F.naturalHeight),n(14,ie=F.getBoundingClientRect().height)}async function O(){b.clear(),await Se(),n(0,r=null),n(19,se=void 0)}let te=0,ne=0,ie=0,w=20,E,Z,oe,re,se;function Le(m){D[m?"unshift":"push"](()=>{y=m,n(8,y),n(0,r)})}const me=m=>($(m),n(1,f="editor")),je=()=>n(1,f="select");function be(m){D[m?"unshift":"push"](()=>{Z=m,n(16,Z)})}function Ne(m){D[m?"unshift":"push"](()=>{b=m,n(11,b)})}function pe(m){w=m,n(15,w)}function ke(m){i=m,n(20,i),n(10,E),n(4,c),n(1,f)}const we=()=>b.undo();function Ae(m){w=m,n(15,w)}function ae(m){i=m,n(20,i),n(10,E),n(4,c),n(1,f)}function ye(m){p=m,n(9,p)}const Ie=()=>b.undo();function ve(m){w=m,n(15,w)}function Ce(m){i=m,n(20,i),n(10,E),n(4,c),n(1,f)}function ze(m){w=m,n(15,w)}function Me(m){i=m,n(20,i),n(10,E),n(4,c),n(1,f)}function le(m){D[m?"unshift":"push"](()=>{b=m,n(11,b)})}const fe=m=>f==="color-sketch"?U(m):he(m,!0);function Te(m){_e.call(this,t,m)}function ge(m){D[m?"unshift":"push"](()=>{y=m,n(8,y),n(0,r)})}const Fe=m=>($(m),n(1,f="editor")),Be=()=>n(1,f="select");function qe(m){D[m?"unshift":"push"](()=>{Z=m,n(16,Z)})}function Oe(m){D[m?"unshift":"push"](()=>{b=m,n(11,b)})}function We(m){w=m,n(15,w)}function Pe(m){i=m,n(20,i),n(10,E),n(4,c),n(1,f)}const h=()=>b.undo();function C(m){w=m,n(15,w)}function z(m){i=m,n(20,i),n(10,E),n(4,c),n(1,f)}function R(){oe=this.offsetHeight,re=this.offsetWidth,n(17,oe),n(18,re)}return t.$$set=m=>{"value"in m&&n(0,r=m.value),"label"in m&&n(2,o=m.label),"show_label"in m&&n(3,l=m.show_label),"source"in m&&n(4,c=m.source),"tool"in m&&n(1,f=m.tool),"streaming"in m&&n(5,g=m.streaming),"pending"in m&&n(6,a=m.pending),"mirror_webcam"in m&&n(7,_=m.mirror_webcam),"$$scope"in m&&n(57,u=m.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&S("change",r),t.$$.dirty[0]&512&&S("drag",p),t.$$.dirty[0]&18&&(c==="canvas"&&f==="sketch"?n(10,E="bw-sketch"):f==="color-sketch"?n(10,E="color-sketch"):(c==="upload"||c==="webcam")&&f==="sketch"?n(10,E="mask"):n(10,E="editor")),t.$$.dirty[0]&1024&&n(20,i=E=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(r===null||r.image===null&&r.mask===null)&&n(19,se=void 0),t.$$.dirty[0]&257&&y&&(r?(n(8,y.image=r,y),y.create()):y.destroy())},[r,f,o,l,c,g,a,_,y,p,E,b,te,ne,ie,w,Z,oe,re,se,i,U,$,he,J,O,s,Le,me,je,be,Ne,pe,ke,we,Ae,ae,ye,Ie,ve,Ce,ze,Me,le,fe,Te,ge,Fe,Be,qe,Oe,We,Pe,h,C,z,R,u]}class wn extends x{constructor(e){super(),ee(this,e,kn,pn,X,{value:0,label:2,show_label:3,source:4,tool:1,streaming:5,pending:6,mirror_webcam:7},null,[-1,-1])}}function An(t){let e,n;return{c(){e=N("img"),q(e.src,n=t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-1ku16gh")},m(i,s){I(i,e,s)},p(i,s){s&1&&!q(e.src,n=i[0])&&d(e,"src",n)},i:j,o:j,d(i){i&&v(e)}}}function yn(t){let e,n;return e=new Ot({props:{size:"large",unpadded_box:!0,$$slots:{default:[In]},$$scope:{ctx:t}}}),{c(){M(e.$$.fragment)},m(i,s){T(e,i,s),n=!0},p(i,s){const u={};s&16&&(u.$$scope={dirty:s,ctx:i}),e.$set(u)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){B(e,i)}}}function In(t){let e,n;return e=new Re({}),{c(){M(e.$$.fragment)},m(i,s){T(e,i,s),n=!0},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){B(e,i)}}}function vn(t){let e,n,i,s,u,r;e=new dt({props:{show_label:t[2],Icon:Re,label:t[1]||"Image"}});const o=[yn,An],l=[];function c(f,g){return f[0]===null?0:1}return i=c(t),s=l[i]=o[i](t),{c(){M(e.$$.fragment),n=L(),s.c(),u=ue()},m(f,g){T(e,f,g),I(f,n,g),l[i].m(f,g),I(f,u,g),r=!0},p(f,[g]){const a={};g&4&&(a.show_label=f[2]),g&2&&(a.label=f[1]||"Image"),e.$set(a);let _=i;i=c(f),i===_?l[i].p(f,g):(G(),A(l[_],1,1,()=>{l[_]=null}),K(),s=l[i],s?s.p(f,g):(s=l[i]=o[i](f),s.c()),k(s,1),s.m(u.parentNode,u))},i(f){r||(k(e.$$.fragment,f),k(s),r=!0)},o(f){A(e.$$.fragment,f),A(s),r=!1},d(f){B(e,f),f&&v(n),l[i].d(f),f&&v(u)}}}function Cn(t,e,n){let{value:i}=e,{label:s=void 0}=e,{show_label:u}=e;const r=ce();return t.$$set=o=>{"value"in o&&n(0,i=o.value),"label"in o&&n(1,s=o.label),"show_label"in o&&n(2,u=o.show_label)},t.$$.update=()=>{t.$$.dirty&1&&i&&r("change",i)},[i,s,u]}class zn extends x{constructor(e){super(),ee(this,e,Cn,vn,X,{value:0,label:1,show_label:2})}}function Mn(t){let e,n,i;function s(r){t[14](r)}let u={source:t[4],tool:t[5],label:t[6],show_label:t[7],pending:t[9],streaming:t[8],mirror_webcam:t[11],$$slots:{default:[Bn]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.value=t[0]),e=new wn({props:u}),D.push(()=>Y(e,"value",s)),e.$on("edit",t[15]),e.$on("clear",t[16]),e.$on("change",t[17]),e.$on("stream",t[18]),e.$on("drag",t[19]),e.$on("upload",t[20]),e.$on("error",t[21]),{c(){M(e.$$.fragment)},m(r,o){T(e,r,o),i=!0},p(r,o){const l={};o&16&&(l.source=r[4]),o&32&&(l.tool=r[5]),o&64&&(l.label=r[6]),o&128&&(l.show_label=r[7]),o&512&&(l.pending=r[9]),o&256&&(l.streaming=r[8]),o&2048&&(l.mirror_webcam=r[11]),o&8388608&&(l.$$scope={dirty:o,ctx:r}),!n&&o&1&&(n=!0,l.value=r[0],Q(()=>n=!1)),e.$set(l)},i(r){i||(k(e.$$.fragment,r),i=!0)},o(r){A(e.$$.fragment,r),i=!1},d(r){B(e,r)}}}function Tn(t){let e,n;return e=new zn({props:{value:t[0],label:t[6],show_label:t[7]}}),{c(){M(e.$$.fragment)},m(i,s){T(e,i,s),n=!0},p(i,s){const u={};s&1&&(u.value=i[0]),s&64&&(u.label=i[6]),s&128&&(u.show_label=i[7]),e.$set(u)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){B(e,i)}}}function Bn(t){let e,n;return e=new Wt({props:{type:"image"}}),{c(){M(e.$$.fragment)},m(i,s){T(e,i,s),n=!0},p:j,i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){B(e,i)}}}function Sn(t){let e,n,i,s,u,r;const o=[t[1]];let l={};for(let a=0;a<o.length;a+=1)l=St(l,o[a]);e=new Et({props:l});const c=[Tn,Mn],f=[];function g(a,_){return a[12]==="static"?0:1}return i=g(t),s=f[i]=c[i](t),{c(){M(e.$$.fragment),n=L(),s.c(),u=ue()},m(a,_){T(e,a,_),I(a,n,_),f[i].m(a,_),I(a,u,_),r=!0},p(a,_){const b=_&2?Rt(o,[Dt(a[1])]):{};e.$set(b);let y=i;i=g(a),i===y?f[i].p(a,_):(G(),A(f[y],1,1,()=>{f[y]=null}),K(),s=f[i],s?s.p(a,_):(s=f[i]=c[i](a),s.c()),k(s,1),s.m(u.parentNode,u))},i(a){r||(k(e.$$.fragment,a),k(s),r=!0)},o(a){A(e.$$.fragment,a),A(s),r=!1},d(a){B(e,a),a&&v(n),f[i].d(a),a&&v(u)}}}function En(t){let e,n;return e=new Bt({props:{visible:t[3],variant:t[12]==="dynamic"&&t[0]===null&&t[4]==="upload"?"dashed":"solid",color:t[13]?"green":"grey",padding:!1,elem_id:t[2],style:{height:t[10].height,width:t[10].width},allow_overflow:!1,$$slots:{default:[Sn]},$$scope:{ctx:t}}}),{c(){M(e.$$.fragment)},m(i,s){T(e,i,s),n=!0},p(i,[s]){const u={};s&8&&(u.visible=i[3]),s&4113&&(u.variant=i[12]==="dynamic"&&i[0]===null&&i[4]==="upload"?"dashed":"solid"),s&8192&&(u.color=i[13]?"green":"grey"),s&4&&(u.elem_id=i[2]),s&1024&&(u.style={height:i[10].height,width:i[10].width}),s&8403955&&(u.$$scope={dirty:s,ctx:i}),e.$set(u)},i(i){n||(k(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){B(e,i)}}}function Rn(t,e,n){let{elem_id:i=""}=e,{visible:s=!0}=e,{value:u=null}=e,{source:r="upload"}=e,{tool:o="editor"}=e,{label:l}=e,{show_label:c}=e,{streaming:f}=e,{pending:g}=e,{style:a={}}=e,{mirror_webcam:_}=e,{loading_status:b}=e,{mode:y}=e;const U=ce();let $;function he(w){u=w,n(0,u)}function S(w){_e.call(this,t,w)}function p(w){_e.call(this,t,w)}function J(w){_e.call(this,t,w)}function O(w){_e.call(this,t,w)}const te=({detail:w})=>n(13,$=w);function ne(w){_e.call(this,t,w)}const ie=({detail:w})=>{n(1,b=b||{}),n(1,b.status="error",b),n(1,b.message=w,b)};return t.$$set=w=>{"elem_id"in w&&n(2,i=w.elem_id),"visible"in w&&n(3,s=w.visible),"value"in w&&n(0,u=w.value),"source"in w&&n(4,r=w.source),"tool"in w&&n(5,o=w.tool),"label"in w&&n(6,l=w.label),"show_label"in w&&n(7,c=w.show_label),"streaming"in w&&n(8,f=w.streaming),"pending"in w&&n(9,g=w.pending),"style"in w&&n(10,a=w.style),"mirror_webcam"in w&&n(11,_=w.mirror_webcam),"loading_status"in w&&n(1,b=w.loading_status),"mode"in w&&n(12,y=w.mode)},t.$$.update=()=>{t.$$.dirty&1&&n(0,u=u||null),t.$$.dirty&1&&U("change")},[u,b,i,s,r,o,l,c,f,g,a,_,y,$,he,S,p,J,O,te,ne,ie]}class Dn extends x{constructor(e){super(),ee(this,e,Rn,En,X,{elem_id:2,visible:3,value:0,source:4,tool:5,label:6,show_label:7,streaming:8,pending:9,style:10,mirror_webcam:11,loading_status:1,mode:12})}}var Jn=Dn;const Hn=["static","dynamic"],Qn=t=>({type:"string",description:"image data as base64 string",example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{Jn as Component,Xn as ExampleComponent,Qn as document,Hn as modes};
//# sourceMappingURL=index.67d06d6b.js.map
